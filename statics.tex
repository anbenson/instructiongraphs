\documentclass[12pt]{article}

\usepackage{mathpartir}
\usepackage{amsmath}
\usepackage{amssymb}

\title{Instruction Graph Statics}
\author{Andrew Benson}
\date{}

\begin{document}
\maketitle

% Frequently used commands
\newcommand{\sort}[1]{\mathtt{#1}}
\newcommand{\syn}[1]{\textbf{#1}}
\newcommand{\nterm}[1]{\mathit{#1}}

% Frequently used syntax
\newcommand{\prog}[2]{\syn{P(}#1,\ #2\syn{)}}
\newcommand{\sing}[1]{\syn{S(}#1\syn{)}}
\newcommand{\cons}[2]{#1\ \syn{::}\ #2}
\newcommand{\ver}[2]{\syn{V(}#1,\ #2\syn{)}}
\newcommand{\doonce}[2]{\syn{do }#1\syn{ then }#2}
\newcommand{\dountil}[3]{\syn{do }#1\syn{ until }#2\syn{ then }#3}
\newcommand{\ifelse}[3]{\syn{if }#1\syn{ then }#2\syn{ else }#3}
\newcommand{\goto}[1]{\syn{goto }#1}
\newcommand{\progend}[0]{\syn{end}}

\newcommand{\singletonset}[1]{\{#1\}}

% Frequently used judgments
\newcommand{\valid}[1]{#1\ \mathtt{valid}}
\newcommand{\defined}[2]{(#1,\ #2)\ \mathtt{defined}}
\newcommand{\connected}[4]{(#1,\ #2,\ #3,\ #4)\ \mathtt{connected}}

\section{Validity}

$\valid{\nterm{p}}$ means that the Program $\nterm{p}$ is a valid program.

\begin{mathpar}
  \inferrule{
    \defined{\nterm{vs}}{\nterm{U}}\\
    \connected{\nterm{vs}}{\nterm{\emptyset}}{\nterm{s}}{\nterm{U}}
  }{
    \valid{\prog{\nterm{vs}}{\nterm{s}}}
  }
\end{mathpar}

\section{Defined}

We let $\nterm{U} \subseteq \mathbb{Z}$ be a subset of the integers.\\

$\defined{\nterm{vs}}{\nterm{U}}$ means that the Vertices $\nterm{vs}$ define
exactly the set $\nterm{U}$ of vertex indices.

\begin{mathpar}
  \inferrule{
  }{
    \defined{\sing{\ver{\nterm{n}}{\nterm{c}}}}{\singletonset{n}}
  }

  \inferrule{
    \defined{\nterm{vs}}{\nterm{U}}\\
    \nterm{n} \notin \nterm{U}
  }{
    \defined{
      \cons{\ver{\nterm{n}}{\nterm{c}}}{\nterm{vs}}
    }{
      \nterm{U} \cup \singletonset{\nterm{n}}
    }
  }
\end{mathpar}

\section{Connected}

We let $\nterm{U} \subseteq \mathbb{Z}$ be a subset of the integers.\\

$\connected{\nterm{vs}}{\nterm{U_v}}{\nterm{n}}{\nterm{U}}$ means that the
vertex represented by $\nterm{n}$ is connected to each vertex represented by an
index in $\nterm{U}$ of the vertices in $\nterm{vs}$, where $\nterm{U_v}$ is the
set of vertex indices of vertices already visited.

\begin{mathpar}
  \inferrule{
    \nterm{n} \in \nterm{U_v}
  }{
    \connected{\nterm{vs}}{\nterm{U_v}}{\nterm{n}}{\nterm{\emptyset}}
  }

  \inferrule{
    \ver{\nterm{n}}{\progend} \in \nterm{vs}\\
    \nterm{n} \notin \nterm{U_v}
  }{
    \connected{\nterm{vs}}{\nterm{U_v}}{\nterm{n}}{\singletonset{\nterm{n}}}
  }

  \inferrule{
    \ver{\nterm{n}}{\doonce{\nterm{a}}{\nterm{n'}}} \in \nterm{vs}\\
    \connected{vs}{U_v \cup \singletonset{n}}{n'}{U}\\
    \nterm{n} \notin \nterm{U_v}
  }{
    \connected{\nterm{vs}}{\nterm{U_v}}{\nterm{n}}{\nterm{U} \cup \singletonset{\nterm{n}}}
  }

  \inferrule{
    \ver{\nterm{n}}{\dountil{\nterm{a}}{\nterm{cnd}}{\nterm{n'}}} \in \nterm{vs}\\
    \connected{vs}{U_v \cup \singletonset{n}}{n'}{U}\\
    \nterm{n} \notin \nterm{U_v}
  }{
    \connected{\nterm{vs}}{\nterm{U_v}}{\nterm{n}}{\nterm{U} \cup \singletonset{\nterm{n}}}
  }

  \inferrule{
    \ver{\nterm{n}}{\ifelse{\nterm{cnd}}{\nterm{n'}}{\nterm{n''}}} \in \nterm{vs}\\
    \connected{vs}{U_v \cup \singletonset{n}}{n'}{U}\\
    \connected{vs}{U_v \cup U \cup \singletonset{n}}{n''}{U'}\\
    \nterm{n} \notin \nterm{U_v}
  }{
    \connected{\nterm{vs}}{\nterm{U_v}}{\nterm{n}}{\nterm{U} \cup \singletonset{\nterm{n}}}
  }

  \inferrule{
    \ver{\nterm{n}}{\goto{\nterm{n'}}} \in \nterm{vs}\\
    \connected{vs}{U_v \cup \singletonset{n}}{n'}{U}\\
    \nterm{n} \notin \nterm{U_v}
  }{
    \connected{\nterm{vs}}{\nterm{U_v}}{\nterm{n}}{\nterm{U} \cup \singletonset{\nterm{n}}}
  }
\end{mathpar}

\end{document}
